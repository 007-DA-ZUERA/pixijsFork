{"version":3,"file":"triangleInstance.js","sources":["../../../../../src/scene/graphics/shared/utils/triangleInstance.ts"],"sourcesContent":["// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport Triangle from 'triangle-wasm';\nimport wasmBase64 from '../../gl/triangle.wasm.base64';\n\nlet triangleInstance: any = null;\nlet triangleInitialized = false;\n\n// Convert base64 to binary and create a blob URL\nfunction base64ToArrayBuffer(base64: string): ArrayBuffer\n{\n    const binaryString = atob(base64);\n    const bytes = new Uint8Array(binaryString.length);\n\n    for (let i = 0; i < binaryString.length; i++)\n    {\n        bytes[i] = binaryString.charCodeAt(i);\n    }\n\n    return bytes.buffer;\n}\n\nfunction getWasmBlobUrl(): string\n{\n    const arrayBuffer = base64ToArrayBuffer(wasmBase64);\n    const blob = new Blob([arrayBuffer], { type: 'application/wasm' });\n\n    return URL.createObjectURL(blob);\n}\n\nexport function getTriangleInstance()\n{\n    if (!triangleInitialized)\n    {\n        console.warn('Triangle-wasm not yet initialized. Call initTriangleWasm() during app startup.');\n    }\n\n    return triangleInstance;\n}\n\nexport async function initTriangleWasm()\n{\n    if (!triangleInstance)\n    {\n        const wasmUrl = getWasmBlobUrl();\n\n        triangleInstance = await Triangle.init(wasmUrl);\n        triangleInitialized = true;\n        \n        // Clean up the blob URL after initialization\n        URL.revokeObjectURL(wasmUrl);\n    }\n\n    return triangleInstance;\n}\n"],"names":["wasmBase64"],"mappings":";;;;;;AAKA,IAAI,gBAAwB,GAAA,IAAA,CAAA;AAC5B,IAAI,mBAAsB,GAAA,KAAA,CAAA;AAG1B,SAAS,oBAAoB,MAC7B,EAAA;AACI,EAAM,MAAA,YAAA,GAAe,KAAK,MAAM,CAAA,CAAA;AAChC,EAAA,MAAM,KAAQ,GAAA,IAAI,UAAW,CAAA,YAAA,CAAa,MAAM,CAAA,CAAA;AAEhD,EAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,YAAA,CAAa,QAAQ,CACzC,EAAA,EAAA;AACI,IAAA,KAAA,CAAM,CAAC,CAAA,GAAI,YAAa,CAAA,UAAA,CAAW,CAAC,CAAA,CAAA;AAAA,GACxC;AAEA,EAAA,OAAO,KAAM,CAAA,MAAA,CAAA;AACjB,CAAA;AAEA,SAAS,cACT,GAAA;AACI,EAAM,MAAA,WAAA,GAAc,oBAAoBA,4BAAU,CAAA,CAAA;AAClD,EAAM,MAAA,IAAA,GAAO,IAAI,IAAK,CAAA,CAAC,WAAW,CAAG,EAAA,EAAE,IAAM,EAAA,kBAAA,EAAoB,CAAA,CAAA;AAEjE,EAAO,OAAA,GAAA,CAAI,gBAAgB,IAAI,CAAA,CAAA;AACnC,CAAA;AAEO,SAAS,mBAChB,GAAA;AACI,EAAA,IAAI,CAAC,mBACL,EAAA;AACI,IAAA,OAAA,CAAQ,KAAK,gFAAgF,CAAA,CAAA;AAAA,GACjG;AAEA,EAAO,OAAA,gBAAA,CAAA;AACX,CAAA;AAEA,eAAsB,gBACtB,GAAA;AACI,EAAA,IAAI,CAAC,gBACL,EAAA;AACI,IAAA,MAAM,UAAU,cAAe,EAAA,CAAA;AAE/B,IAAmB,gBAAA,GAAA,MAAM,QAAS,CAAA,IAAA,CAAK,OAAO,CAAA,CAAA;AAC9C,IAAsB,mBAAA,GAAA,IAAA,CAAA;AAGtB,IAAA,GAAA,CAAI,gBAAgB,OAAO,CAAA,CAAA;AAAA,GAC/B;AAEA,EAAO,OAAA,gBAAA,CAAA;AACX;;;;;"}